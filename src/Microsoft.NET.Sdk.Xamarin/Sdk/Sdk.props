<Project>
  <PropertyGroup>
    <MSBuildAllProjects>$(MSBuildAllProjects);$(MSBuildThisFileFullPath)</MSBuildAllProjects>
  </PropertyGroup>

  <Choose>
    <When Condition="'$(MSBuildProjectExtension)' == '.csproj' or ('$(MSBuildProjectExtension)' == '.tmp_proj' and Exists('$(MSBuildProjectDirectory)\$(AssemblyName).csproj'))">
      <PropertyGroup>
        <_SdkLanguageName>CSharp</_SdkLanguageName>
        <_SdkLanguageExtension>.cs</_SdkLanguageExtension>
      </PropertyGroup>
    </When>

    <When Condition="'$(MSBuildProjectExtension)' == '.vbproj' or ('$(MSBuildProjectExtension)' == '.tmp_proj' and Exists('$(MSBuildProjectDirectory)\$(AssemblyName).vbproj'))">
      <PropertyGroup>
        <_SdkLanguageName>VisualBasic</_SdkLanguageName>
        <_SdkLanguageExtension>.vb</_SdkLanguageExtension>
      </PropertyGroup>
    </When>

    <When Condition="'$(MSBuildProjectExtension)' == '.fsproj' or ('$(MSBuildProjectExtension)' == '.tmp_proj' and Exists('$(MSBuildProjectDirectory)\$(AssemblyName).fsproj'))">
      <PropertyGroup>
        <_SdkLanguageName>FSharp</_SdkLanguageName>
        <_SdkLanguageExtension>.fs</_SdkLanguageExtension>
      </PropertyGroup>
    </When>

    <Otherwise />
  </Choose>

  <!-- Convert $(TargetFramework) to lower case and split $(TargetFramework) (e.g. net45) into short identifier and short version (e.g. 'net' and '45'). -->
  <PropertyGroup Condition="'$(TargetFramework)' != ''">
    <TargetFramework>$(TargetFramework.ToLowerInvariant())</TargetFramework>
    <_SdkShortFrameworkIdentifier>$(TargetFramework.TrimEnd('.0123456789'))</_SdkShortFrameworkIdentifier>
    <_SdkShortFrameworkVersion>$(TargetFramework.Substring($(_SdkShortFrameworkIdentifier.Length)))</_SdkShortFrameworkVersion>
  </PropertyGroup>

  <PropertyGroup>
    <TargetFrameworkIdentifier Condition="'$(_SdkShortFrameworkIdentifier)' == 'xamarinandroid'">Xamarin.Android</TargetFrameworkIdentifier>
    <TargetFrameworkIdentifier Condition="'$(_SdkShortFrameworkIdentifier)' == 'xamarin.android'">Xamarin.Android</TargetFrameworkIdentifier>

    <TargetFrameworkIdentifier Condition="'$(_SdkShortFrameworkIdentifier)' == 'xamarinios'">Xamarin.iOS</TargetFrameworkIdentifier>
    <TargetFrameworkIdentifier Condition="'$(_SdkShortFrameworkIdentifier)' == 'xamarin.ios'">Xamarin.iOS</TargetFrameworkIdentifier>

    <TargetFrameworkIdentifier Condition="'$(_SdkShortFrameworkIdentifier)' == 'xamarinmac'">Xamarin.Mac</TargetFrameworkIdentifier>
    <TargetFrameworkIdentifier Condition="'$(_SdkShortFrameworkIdentifier)' == 'xamarin.mac'">Xamarin.Mac</TargetFrameworkIdentifier>

    <TargetFrameworkIdentifier Condition="'$(_SdkShortFrameworkIdentifier)' == 'xamarintvos'">Xamarin.TVOS</TargetFrameworkIdentifier>
    <TargetFrameworkIdentifier Condition="'$(_SdkShortFrameworkIdentifier)' == 'xamarin.tvos'">Xamarin.TVOS</TargetFrameworkIdentifier>

    <TargetFrameworkIdentifier Condition="'$(_SdkShortFrameworkIdentifier)' == 'xamarinwatchos'">Xamarin.WatchOS</TargetFrameworkIdentifier>
    <TargetFrameworkIdentifier Condition="'$(_SdkShortFrameworkIdentifier)' == 'xamarin.watchos'">Xamarin.WatchOS</TargetFrameworkIdentifier>
  </PropertyGroup>

  <Import Project="Sdk.props" Sdk="Microsoft.NET.Sdk" />
  <Import Project="$(MSBuildThisFileDirectory)/../build/$(TargetFrameworkIdentifier).props" />
</Project>
